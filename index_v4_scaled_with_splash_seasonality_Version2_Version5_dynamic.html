<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Primus Traders | Empowering Disciplined Traders</title>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="description" content="Empowering disciplined traders with high-impact USD catalysts, multi‑asset charts, positioning & sentiment (COT + AAII), curated news and a focused execution journal." />
<meta name="theme-color" content="#f8f5f1" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
/* (UNCHANGED STYLES – truncated comment) */
:root{
  --font:'Roboto',system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Arial,sans-serif;
  --fs-1:clamp(.63rem,.57rem + .25vw,.72rem);
  --fs-2:clamp(.70rem,.64rem + .35vw,.83rem);
  --fs-3:clamp(.78rem,.7rem + .5vw,.95rem);
  --fs-4:clamp(1.0rem,.9rem + .9vw,1.35rem);
  --fs-h3:clamp(1.05rem,.9rem + 1.2vw,1.55rem);
  --fs-h2:clamp(1.55rem,1.15rem + 2.2vw,2.25rem);
  --fs-h1:clamp(2.15rem,1.4rem + 3.3vw,3.3rem);
  --lh-tight:1.15;--lh-body:1.52;
  --space-0:0;--space-1:.25rem;--space-2:.5rem;--space-3:.75rem;
  --space-4:1rem;--space-5:1.25rem;--space-6:1.5rem;--space-7:1.9rem;
  --space-8:2.4rem;--space-9:3rem;--space-10:3.8rem;
  --container-max:1220px;
  --radius-sm:6px;--radius-md:14px;--radius-lg:24px;--radius-xl:32px;--radius-full:999px;
  --bg:#f8f5f1;--bg-alt:#f3eee8;--surface:#ffffff;--surface-alt:#f6f1ec;--surface-accent:#f1e9e1;
  --border:#e2d7cc;--border-strong:#cfbeaf;
  --text:#2e2721;--text-soft:#6b5f55;--text-faint:#9a8f85;
  --accent:#b27934;--accent-hover:#c6893f;--accent-warm:#d6a357;
  --shadow-sm:0 2px 6px -2px rgba(55,38,21,.18),0 1px 2px rgba(55,38,21,.08);
  --shadow-md:0 14px 34px -16px rgba(55,38,21,.38),0 6px 16px -4px rgba(55,38,21,.22);
  --trans:.28s cubic-bezier(.55,.2,.2,.95);
  --focus-ring:0 0 0 3px rgba(178,121,52,.45);
  --hero-bg:radial-gradient(circle at 32% 25%,#ffffff 0%,#f3ece4 55%,#ece2d8 100%);
}
*{box-sizing:border-box;margin:0;padding:0}
html{font-size:17px;-webkit-text-size-adjust:100%;scroll-behavior:smooth}
body{font-family:var(--font);font-size:var(--fs-3);line-height:var(--lh-body);background:var(--bg);background-image:var(--hero-bg);color:var(--text);-webkit-font-smoothing:antialiased;min-height:100vh;overflow-x:hidden}
img{max-width:100%;display:block}
h1,h2,h3{font-weight:900;letter-spacing:-.5px;line-height:var(--lh-tight);margin:0 0 var(--space-4)}
h1{font-size:var(--fs-h1)}h2{font-size:var(--fs-h2)}h3{font-size:var(--fs-h3)}
p{margin:0 0 var(--space-4)}
p.lead{font-size:var(--fs-4);color:var(--text-soft);max-width:70ch}
small,.small{font-size:var(--fs-2)}
a{color:var(--accent);text-decoration:none;transition:var(--trans)}
a:hover{color:var(--accent-hover)}
:focus-visible{outline:none;box-shadow:var(--focus-ring);border-radius:6px}
.container{max-width:var(--container-max);margin:0 auto;padding:0 clamp(var(--space-4),3vw,var(--space-6))}
.section{padding:var(--space-9) 0 var(--space-8)}
.section + .section{padding-top:var(--space-8)}
.section-header{margin:0 0 var(--space-6)}
.section-header p{font-size:var(--fs-2);margin:var(--space-2) 0 0;color:var(--text-soft);max-width:68ch}
.value-points{list-style:none;padding:0;margin:var(--space-5) 0 0;display:flex;flex-wrap:wrap;gap:var(--space-3);font-size:var(--fs-2);font-weight:600;color:var(--text-soft);letter-spacing:.4px}
.site-header{position:sticky;top:0;z-index:90;background:rgba(255,255,255,.9);backdrop-filter:blur(9px);border-bottom:1px solid var(--border);box-shadow:0 3px 14px -10px rgba(0,0,0,.35)}
.nav-wrapper{display:flex;align-items:center;justify-content:space-between;gap:var(--space-4);min-height:72px}
.logo{display:flex;align-items:center;gap:var(--space-3);font-size:var(--fs-3);font-weight:700;color:var(--text);line-height:1;white-space:nowrap}
.logo-mark{width:44px;height:44px;border-radius:16px;background:linear-gradient(135deg,var(--accent),var(--accent-hover) 60%,var(--accent-warm));display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.05rem;color:#fff;box-shadow:var(--shadow-sm)}
.nav-links{list-style:none;display:flex;align-items:center;gap:var(--space-2);flex-wrap:wrap}
.nav-links a{padding:.55rem .9rem;font-size:var(--fs-2);font-weight:600;border-radius:var(--radius-full);color:var(--text-soft);line-height:1;transition:var(--trans)}
.nav-links a.active,.nav-links a:hover{background:var(--surface-alt);color:var(--text)}
.nav-toggle{display:none;background:none;border:none;flex-direction:column;gap:5px;cursor:pointer;padding:.65rem}
.nav-toggle span{width:28px;height:3px;background:var(--text);border-radius:2px;transition:var(--trans)}
@media(max-width:860px){
 .nav-links{position:absolute;top:72px;right:var(--space-4);background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:var(--space-5) var(--space-5) var(--space-4);flex-direction:column;align-items:stretch;gap:var(--space-2);box-shadow:var(--shadow-md);opacity:0;transform:translateY(-10px) scale(.97);pointer-events:none;transition:var(--trans)}
 .nav-links.open{opacity:1;transform:translateY(0) scale(1);pointer-events:auto}
 .nav-toggle{display:flex}
}
.hero{padding:var(--space-10) 0 var(--space-9);position:relative;overflow:hidden}
.hero-grid{display:grid;gap:var(--space-8);grid-template-columns:repeat(auto-fit,minmax(360px,1fr));align-items:start}
.catalyst-pill{display:inline-flex;align-items:center;gap:.45rem;background:var(--surface-alt);border:1px solid var(--border);padding:.5rem .95rem .45rem;font-size:var(--fs-1);font-weight:700;letter-spacing:.75px;text-transform:uppercase;border-radius:var(--radius-full);color:var(--accent)}
.panel{background:linear-gradient(140deg,#ffffff 0%,#f7f2ed 70%,#f2ece6);border:1px solid var(--border);border-radius:var(--radius-lg);padding:var(--space-6) var(--space-6) var(--space-5);box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:var(--space-4);min-height:100%;transition:var(--trans)}
.panel:hover{transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:var(--accent-hover)}
.subheading{font-size:var(--fs-1);letter-spacing:2px;font-weight:700;text-transform:uppercase;margin:0;color:var(--accent)}
.mini-desc{font-size:var(--fs-2);color:var(--text-soft);margin:0}
.asset-switcher{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center}
.asset-switcher button{background:var(--surface-alt);border:1px solid var(--border-strong);padding:.45rem .85rem .4rem;font-size:var(--fs-1);font-weight:600;letter-spacing:.5px;border-radius:var(--radius-full);cursor:pointer;color:var(--text-soft);transition:var(--trans)}
.asset-switcher button.active,.asset-switcher button:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.chart-wrapper{flex:1 1 auto;min-height:300px;border:1.5px solid var(--border-strong);border-radius:16px;background:#fff;position:relative;overflow:hidden}
.chart-wrapper.loading::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,rgba(255,255,255,0) 0%,rgba(215,200,185,.6) 50%,rgba(255,255,255,0) 100%);animation:shimmer 1.4s linear infinite}
@keyframes shimmer{0%{transform:translateX(-40%)}100%{transform:translateX(120%)}}
.btn{--bg:var(--accent);--color:#fff;display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.78rem 1.3rem .72rem;border:none;border-radius:var(--radius-full);font-size:var(--fs-1);letter-spacing:.7px;font-weight:700;text-transform:uppercase;background:var(--bg);color:var(--color);cursor:pointer;box-shadow:0 2px 10px -2px rgba(0,0,0,.2),0 4px 14px -6px rgba(178,121,52,.4);transition:var(--trans)}
.btn:hover{transform:translateY(-2px);background:var(--accent-hover);box-shadow:0 7px 22px -10px rgba(178,121,52,.55)}
.btn:active{transform:translateY(0)}
.btn.outline{--bg:#fff;--color:var(--accent);background:var(--bg);border:1.6px solid var(--border-strong);box-shadow:none}
.btn.outline:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.btn.ghost{--bg:var(--surface-alt);--color:var(--accent);border:1.3px solid var(--border);background:var(--bg);color:var(--color)}
.btn.ghost:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.btn.small{padding:.52rem .9rem .46rem;font-size:var(--fs-1);letter-spacing:.6px;box-shadow:none}
.pulse-grid{display:grid;gap:var(--space-7);grid-template-columns:repeat(auto-fit,minmax(360px,1fr));align-items:start}
.card{background:var(--surface);border:1px solid var(--border-strong);border-radius:var(--radius-lg);padding:var(--space-6) var(--space-6) var(--space-5);box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:var(--space-4);min-height:100%;transition:var(--trans)}
.card:hover{transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:var(--accent-hover)}
.card-title{margin:0;font-size:var(--fs-1);letter-spacing:2px;text-transform:uppercase;font-weight:700;color:var(--accent)}
.high-impact-note{font-size:var(--fs-1);color:var(--text-faint);margin:var(--space-2) 0 0}
.positioning-wrap{display:flex;flex-direction:column;gap:var(--space-4)}
.metric-block{background:var(--surface-alt);border:1px solid var(--border);border-radius:16px;padding:var(--space-5) var(--space-5) var(--space-4);display:flex;flex-direction:column;gap:var(--space-3)}
.metric-head{display:flex;align-items:center;justify-content:space-between;gap:var(--space-3);flex-wrap:wrap}
.metric-head h4{margin:0;font-size:var(--fs-2);font-weight:700;letter-spacing:.4px;display:flex;align-items:center;gap:.5rem}
.delta-positive{color:#2f7d46;font-weight:700}
.delta-negative{color:#b44838;font-weight:700}
.inline-badge{background:var(--accent);color:#fff;font-size:var(--fs-1);font-weight:600;padding:.25rem .55rem .2rem;border-radius:var(--radius-full);letter-spacing:.5px}
.cot-bars{display:flex;flex-direction:column;gap:.5rem}
.cot-row{display:flex;align-items:center;gap:.75rem;font-size:var(--fs-2)}
.cot-label{flex:0 0 130px;font-weight:600;color:var(--text-soft)}
.cot-bar-wrap{flex:1;display:flex;align-items:center;gap:.5rem}
.cot-bar{position:relative;height:14px;border-radius:7px;overflow:hidden;background:var(--surface)}
.cot-bar span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-hover))}
.cot-val{font-size:var(--fs-2);font-weight:600;color:var(--text)}
.aaii-grid{display:grid;gap:.75rem;grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}
.aaii-item{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:.7rem .75rem .65rem;display:flex;flex-direction:column;gap:.25rem;align-items:flex-start}
.aaii-item h5{margin:0;font-size:var(--fs-1);letter-spacing:.5px;font-weight:700;color:var(--accent)}
.aaii-bar{width:100%;height:8px;background:var(--surface-alt);border-radius:6px;overflow:hidden;position:relative}
.aaii-bar span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-hover))}
.note{font-size:var(--fs-1);color:var(--text-faint);line-height:1.35}
.team-grid{display:grid;gap:var(--space-6);grid-template-columns:repeat(auto-fill,minmax(180px,1fr));align-items:stretch}
.team-card{background:var(--surface);border:1px solid var(--border-strong);border-radius:20px;padding:var(--space-6) var(--space-5) var(--space-5);box-shadow:var(--shadow-sm);text-align:center;display:flex;flex-direction:column;gap:var(--space-3);transition:var(--trans);min-height:100%}
.team-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:var(--accent)}
.team-avatar{width:68px;height:68px;border-radius:50%;object-fit:cover;margin:0 auto;border:3px solid #fff;box-shadow:0 0 0 3px rgba(178,121,52,.3);background:#eee}
.team-name{font-size:var(--fs-2);font-weight:600;margin:0}
.team-role{font-size:var(--fs-1);letter-spacing:1px;text-transform:uppercase;font-weight:700;color:var(--accent);margin:0}
.team-principle{font-size:var(--fs-1);color:var(--text-soft);line-height:1.36;margin:0;flex-grow:1;display:flex;align-items:center;justify-content:center}
.news-controls{display:flex;flex-wrap:wrap;gap:var(--space-3);margin:0 0 var(--space-6)}
.news-controls input,.news-controls select{padding:.55rem .85rem;font-size:var(--fs-1);border:1px solid var(--border-strong);background:var(--surface-alt);border-radius:var(--radius-full);font-family:var(--font);color:var(--text);transition:var(--trans);min-width:9rem}
.news-controls input:focus,.news-controls select:focus{box-shadow:var(--focus-ring);outline:none;border-color:var(--accent)}
#newsGrid{display:grid;gap:var(--space-6);grid-template-columns:repeat(auto-fill,minmax(250px,1fr));align-items:stretch}
.news-card{background:var(--surface);border:1px solid var(--border-strong);border-radius:20px;padding:var(--space-5);box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:var(--space-3);font-size:var(--fs-2);transition:var(--trans);position:relative;min-height:100%}
.news-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:var(--accent)}
.news-meta{display:flex;flex-wrap:wrap;gap:var(--space-2);font-size:var(--fs-1);text-transform:uppercase;letter-spacing:.65px;color:var(--text-faint);line-height:1.2}
.topic-badge{background:var(--accent);color:#fff;padding:.24rem .58rem .2rem;font-size:var(--fs-1);font-weight:600;letter-spacing:.6px;border-radius:var(--radius-full)}
.news-actions{margin-top:auto;display:flex;gap:var(--space-2)}
.icon-btn{width:30px;height:30px;border:1px solid var(--border-strong);background:var(--surface-alt);border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:var(--fs-2);cursor:pointer;color:var(--accent);transition:var(--trans)}
.icon-btn:hover,.icon-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.filter-row{display:flex;flex-wrap:wrap;gap:var(--space-3);margin:0 0 var(--space-6)}
.filter-btn{background:var(--surface-alt);border:1.3px solid var(--border-strong);padding:.52rem .95rem .48rem;font-size:var(--fs-1);font-weight:700;letter-spacing:.75px;text-transform:uppercase;border-radius:var(--radius-full);color:var(--accent);cursor:pointer;transition:var(--trans)}
.filter-btn:hover,.filter-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.tools-bar{display:flex;flex-wrap:wrap;gap:var(--space-3);margin:0 0 var(--space-5)}
.tools-bar button{background:var(--surface-alt);border:1px solid var(--border-strong);padding:.55rem .95rem .5rem;font-size:var(--fs-1);font-weight:600;letter-spacing:.6px;text-transform:uppercase;border-radius:var(--radius-full);color:var(--accent);cursor:pointer;transition:var(--trans)}
.tools-bar button:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.blog-grid{display:grid;gap:var(--space-6);grid-template-columns:repeat(auto-fill,minmax(235px,1fr));align-items:start}
.post-card{background:var(--surface);border:1px solid var(--border-strong);border-radius:18px;padding:var(--space-5);box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:var(--space-3);position:relative;font-size:var(--fs-2);min-height:100%;transition:var(--trans)}
.post-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-md);border-color:var(--accent)}
.post-meta{display:flex;flex-wrap:wrap;gap:var(--space-2);font-size:var(--fs-1);letter-spacing:.65px;text-transform:uppercase;color:var(--text-faint);line-height:1.2}
.badge{background:var(--accent);color:#fff;padding:.28rem .55rem .22rem;font-size:var(--fs-1);border-radius:var(--radius-full);font-weight:600;letter-spacing:.6px}
.sentiment-ind{position:absolute;top:8px;right:8px;width:10px;height:10px;border-radius:50%;background:#bbb}
.sentiment-ind[data-sent="1"]{background:#c14a3a}
.sentiment-ind[data-sent="2"]{background:#d38644}
.sentiment-ind[data-sent="3"]{background:#cdb04f}
.sentiment-ind[data-sent="4"]{background:#6aa259}
.sentiment-ind[data-sent="5"]{background:#378046}
.blog-form{display:flex;flex-direction:column;gap:var(--space-4);margin-top:var(--space-6)}
.blog-form input,.blog-form select,.blog-form textarea{padding:.75rem 1rem;border:1.4px solid var(--border-strong);border-radius:18px;background:var(--surface-alt);font-family:var(--font);font-size:var(--fs-2);color:var(--text);transition:var(--trans)}
.blog-form textarea{min-height:96px;resize:vertical;line-height:1.4}
.blog-form input:focus,.blog-form select:focus,.blog-form textarea:focus{outline:none;box-shadow:var(--focus-ring);border-color:var(--accent)}
.char-counter{font-size:var(--fs-1);text-align:right;margin-top:-.35rem;color:var(--text-faint)}
.cta-box{background:linear-gradient(145deg,#ffffff,#f5eee7);border:1px solid var(--border);border-radius:var(--radius-xl);padding:var(--space-9) var(--space-7);text-align:center;box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:var(--space-6);transition:var(--trans);overflow:hidden}
.cta-box:hover{box-shadow:var(--shadow-md);border-color:var(--accent)}
.framework-steps{display:grid;gap:var(--space-5);grid-template-columns:repeat(auto-fill,minmax(160px,1fr));list-style:none;padding:0;margin:var(--space-7) 0 var(--space-8);counter-reset:fw}
.framework-steps li{background:var(--surface);border:1px solid var(--border-strong);border-radius:20px;padding:var(--space-5);font-size:var(--fs-1);display:flex;flex-direction:column;gap:var(--space-3);line-height:1.35;position:relative;box-shadow:var(--shadow-sm);min-height:100%;transition:var(--trans)}
.framework-steps li:hover{transform:translateY(-4px);border-color:var(--accent);box-shadow:var(--shadow-md)}
.framework-steps li::before{counter-increment:fw;content:counter(fw);position:absolute;top:-12px;left:12px;background:var(--accent);color:#fff;font-size:var(--fs-1);font-weight:700;padding:.32rem .58rem .28rem;border-radius:12px;box-shadow:var(--shadow-sm)}
.site-footer{background:var(--surface);border-top:1px solid var(--border);margin-top:var(--space-9);padding:var(--space-9) 0 var(--space-8)}
.footer-grid{display:grid;gap:var(--space-8);grid-template-columns:repeat(auto-fit,minmax(220px,1fr));align-items:start;margin-bottom:var(--space-7)}
.footer-links{list-style:none;padding:0;margin:var(--space-3) 0 0;display:flex;flex-direction:column;gap:.5rem}
.footer-links a{font-size:var(--fs-1);color:var(--text-soft);line-height:1.2}
.footer-links a:hover{color:var(--text)}
#scrollTopBtn{position:fixed;right:clamp(.75rem,1.8vw,1.4rem);bottom:clamp(.75rem,2vw,1.4rem);z-index:120;background:var(--accent);color:#fff;border:none;border-radius:var(--radius-full);padding:.7rem .9rem .65rem;font-size:var(--fs-1);font-weight:700;letter-spacing:.5px;cursor:pointer;box-shadow:0 7px 22px -10px rgba(178,121,52,.6);opacity:0;transform:translateY(12px);transition:var(--trans)}
#scrollTopBtn.visible{opacity:1;transform:translateY(0)}
#scrollTopBtn:hover{background:var(--accent-hover)}
.fade-in{animation:fadeIn .55s var(--trans)}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
@media(max-width:640px){
  .hero{padding:var(--space-9) 0 var(--space-8)}
  .panel,.card{padding:var(--space-6) var(--space-5)}
  .framework-steps{gap:var(--space-4)}
  .blog-grid{gap:var(--space-5)}
  .cot-label{flex:0 0 90px}
}
@media(prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}
body.splash-lock{overflow:hidden;height:100vh}
#splash{position:fixed;inset:0;z-index:999;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 50% 40%,#ffffff 0%,#f3ece4 60%,#e9dfd3 100%);transition:opacity .6s ease,transform .6s ease;font-family:var(--font)}
#splash.hide{opacity:0;transform:scale(.985);pointer-events:none}
.splash-inner{display:flex;flex-direction:column;align-items:center;gap:var(--space-6);text-align:center;padding:var(--space-8) var(--space-7)}
.splash-logo{width:88px;height:88px;border-radius:24px;background:linear-gradient(135deg,var(--accent),var(--accent-hover) 55%,var(--accent-warm));box-shadow:0 10px 30px -12px rgba(178,121,52,.55),0 4px 12px rgba(110,70,30,.25);display:flex;align-items:center;justify-content:center;font-size:2.1rem;font-weight:800;color:#fff;letter-spacing:-1px;animation:popIn .9s cubic-bezier(.25,.7,.2,1)}
@keyframes popIn{0%{transform:scale(.6);opacity:0}60%{transform:scale(1.08);opacity:1}100%{transform:scale(1)}}
.splash-title{font-size:clamp(1.55rem,1.1rem + 1.6vw,2.35rem);font-weight:900;letter-spacing:-1.2px;background:linear-gradient(90deg,var(--accent),var(--accent-hover) 50%,var(--accent-warm));-webkit-background-clip:text;color:transparent;background-size:180% 100%;animation:shimmer 3.2s linear infinite;line-height:1.05}
@keyframes shimmer{0%{background-position:0% 50%}100%{background-position:100% 50%}}
.loading-bar{width:260px;max-width:70vw;height:8px;border-radius:5px;background:#e8ddd2;overflow:hidden;position:relative;box-shadow:inset 0 0 0 1px #decfbe}
.loading-bar span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-warm));animation:barFill 2.4s cubic-bezier(.45,.8,.25,1) forwards}
@keyframes barFill{0%{width:0%}55%{width:68%}100%{width:100%}}
.splash-skip{position:absolute;right:14px;bottom:14px;background:rgba(0,0,0,.06);color:var(--text-soft);font-size:var(--fs-1);font-weight:600;letter-spacing:.7px;padding:.5rem .85rem .45rem;border:1px solid rgba(0,0,0,.12);border-radius:var(--radius-full);cursor:pointer;opacity:0;transition:.4s}
#splash:hover .splash-skip,.splash-skip:focus-visible{opacity:1}
.splash-skip:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
</style>
</head>
<body class="splash-lock">
<!-- SPLASH -->
<div id="splash" role="dialog" aria-label="Loading Primus Traders">
  <div class="splash-inner">
    <div class="splash-logo">P</div>
    <div class="splash-title" aria-hidden="true">Primus Traders</div>
    <div class="loading-bar" aria-hidden="true"><span></span></div>
    <button class="splash-skip" id="splashSkip">Skip</button>
  </div>
</div>

<header class="site-header">
  <div class="container nav-wrapper">
    <a href="#" class="logo">
      <span class="logo-mark">P</span>
      <span class="logo-text">Primus<span style="background:linear-gradient(90deg,var(--accent),var(--accent-hover));-webkit-background-clip:text;color:transparent">Traders</span></span>
    </a>
    <nav aria-label="Main navigation">
      <button class="nav-toggle" aria-expanded="false" aria-controls="navMenu" id="navToggle">
        <span></span><span></span><span></span>
      </button>
      <ul class="nav-links" id="navMenu">
        <li><a class="active" href="#">Home</a></li>
        <li><a href="#marketPulse">Calendar</a></li>
        <li><a href="#team">Traders</a></li>
        <li><a href="#marketNews">News</a></li>
        <li><a href="#liveBlog">Blog</a></li>
        <li><a href="#framework">Framework</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- HERO -->
<section class="hero" aria-labelledby="heroTitle">
  <div class="container hero-grid">
    <div>
      <div class="catalyst-pill" id="todayCatalyst">Today: Loading…</div>
      <h1 id="heroTitle">Empowering Disciplined Traders</h1>
      <p class="lead">High‑impact USD catalyst focus, multi‑asset situational awareness, institutional positioning & sentiment, curated narrative flow and a local execution journal—centered on process over impulse.</p>
      <div style="display:flex;flex-wrap:wrap;gap:var(--space-4);margin:var(--space-6) 0 var(--space-5)">
        <a class="btn" href="#marketPulse">Catalysts</a>
        <a class="btn outline" href="#team">Traders</a>
        <a class="btn ghost" href="#liveBlog">Journal</a>
      </div>
      <ul class="value-points">
        <li>High Impact USD Only</li>
        <li>Multi‑Asset Quick View</li>
        <li>COT & AAII Sentiment</li>
        <li>Local Execution Journal</li>
      </ul>
    </div>
    <div class="panel" id="multiAssetPanel">
      <div>
        <h2 class="subheading">Multi‑Asset Quick Charts</h2>
        <p class="mini-desc">Toggle between DXY, S&P 500 (ES), and Gold continuous futures.</p>
      </div>
      <div class="asset-switcher" role="tablist" aria-label="Select asset to display" id="assetSwitcher">
        <button type="button" class="active" data-symbol="TVC:DXY" aria-selected="true" role="tab">DXY</button>
        <button type="button" data-symbol="CME_MINI:ES1!" aria-selected="false" role="tab">ES</button>
        <button type="button" data-symbol="COMEX:GC1!" aria-selected="false" role="tab">Gold</button>
      </div>
      <div class="chart-wrapper loading" id="multiAssetChart" aria-label="Asset price chart"></div>
      <p class="small faint" style="margin:0">Data via TradingView. Illustrative only. Not investment advice.</p>
    </div>
  </div>
</section>

<!-- CALENDAR + POSITIONING / SENTIMENT -->
<section id="marketPulse" class="section" aria-labelledby="pulseHeading">
  <div class="container">
    <header class="section-header">
      <h2 id="pulseHeading">High‑Impact USD Catalysts & Positioning / Sentiment</h2>
      <p>Only USD high‑importance economic events plus current week NASDAQ COT (non‑commercial net) & AAII retail sentiment snapshot.</p>
    </header>
    <div class="pulse-grid">
      <div class="card">
        <h3 class="card-title">Upcoming Events</h3>
        <div id="mainCalendar" class="tradingview-widget-container"></div>
        <p class="high-impact-note">Filter: USD • High Impact.</p>
      </div>
      <div class="card">
        <h3 class="card-title">Positioning & Sentiment</h3>
        <div class="positioning-wrap">
          <div class="metric-block" id="cotBlock">
            <div class="metric-head">
              <h4 style="margin:0;">NASDAQ COT <span class="inline-badge" id="cotWeekLabel">Wk</span></h4>
              <div class="small" id="cotDateLabel"></div>
            </div>
            <div class="cot-bars" id="cotBars"></div>
            <div class="note">Non‑commercial net positioning (contracts). Δ vs prior week. Data ~3 day lag.</div>
          </div>
          <div class="metric-block" id="aaiiBlock">
            <div class="metric-head">
              <h4 style="margin:0;">AAII Sentiment <span class="inline-badge" id="aaiiWeekLabel">Latest</span></h4>
              <div class="small" id="aaiiDateLabel"></div>
            </div>
            <div class="aaii-grid" id="aaiiGrid"></div>
            <div class="note">AAII weekly survey. Use extremes as context only.</div>
          </div>
          <p class="small faint" style="margin:0">Sources: CFTC, AAII (illustrative; ensure license for distribution). Auto-updated weekly.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- TEAM -->
<section id="team" class="section" aria-labelledby="teamHeading">
  <div class="container">
    <header class="section-header">
      <h2 id="teamHeading">Meet the Traders</h2>
      <p>Principles guiding contextual awareness & disciplined execution.</p>
    </header>
    <div class="team-grid">
      <div class="team-card"><img class="team-avatar" src="https://via.placeholder.com/150?text=S" alt="Sajid"><p class="team-name">Sajid</p><p class="team-role">Lead Strategist</p><p class="team-principle">Bias only after catalyst & structural confirmation.</p></div>
      <div class="team-card"><img class="team-avatar" src="https://via.placeholder.com/150?text=M" alt="Mubeen"><p class="team-name">Mubeen</p><p class="team-role">Structure</p><p class="team-principle">Liquidity sweep + rejection > generic pattern names.</p></div>
      <div class="team-card"><img class="team-avatar" src="https://via.placeholder.com/150?text=Sa" alt="Saf"><p class="team-name">Saf</p><p class="team-role">Risk</p><p class="team-principle">Size anchored to volatility & invalidation.</p></div>
      <div class="team-card"><img class="team-avatar" src="https://via.placeholder.com/150?text=So" alt="Sofia"><p class="team-name">Sofia</p><p class="team-role">Execution</p><p class="team-principle">Trigger clarity + no disqualifiers = go.</p></div>
      <div class="team-card"><img class="team-avatar" src="https://via.placeholder.com/150?text=Z" alt="Zain"><p class="team-name">Zain</p><p class="team-role">Psychology</p><p class="team-principle">Track emotional variance like drawdown.</p></div>
    </div>
  </div>
</section>

<!-- NEWS -->
<section id="marketNews" class="section" aria-labelledby="newsHeading">
  <div class="container">
    <header class="section-header">
      <h2 id="newsHeading">Market News Stream</h2>
      <p>Pin only what shapes the session narrative. Sample placeholder feed.</p>
    </header>
    <div class="news-controls">
      <input id="newsSearch" type="search" placeholder="Search..." aria-label="Search news">
      <select id="newsSource" aria-label="Source">
        <option value="">All Sources</option>
        <option>Bloomberg</option><option>Reuters</option><option>MarketWatch</option>
      </select>
      <select id="newsTopic" aria-label="Topic">
        <option value="">All Topics</option>
        <option value="macro">Macro</option><option value="equities">Equities</option>
        <option value="rates">Rates</option><option value="fx">FX</option>
        <option value="commodities">Commodities</option><option value="sentiment">Sentiment</option>
      </select>
      <button class="btn small outline" id="refreshNews" type="button">Refresh</button>
      <span class="small faint" id="newsTimer">Auto: 60s</span>
      <span class="small faint" id="newsUpdated" aria-live="polite"></span>
    </div>
    <div id="pinnedNews" aria-label="Pinned headlines" style="margin-bottom:var(--space-5)"></div>
    <div id="newsGrid" aria-live="polite" aria-busy="true"></div>
    <p class="small faint" style="margin-top:var(--space-5)">Placeholder feed. Replace with licensed sources via backend proxy. Not investment advice.</p>
  </div>
</section>

<!-- LIVE BLOG -->
<section id="liveBlog" class="section" aria-labelledby="blogHeading">
  <div class="container">
    <header class="section-header">
      <h2 id="blogHeading">Live Journal</h2>
      <p>Local only. Capture prep, intraday adjustments & post-session reflections.</p>
    </header>
    <div class="filter-row" id="blogFilters" role="toolbar">
      <button class="filter-btn active" data-filter="all" aria-pressed="true">All</button>
      <button class="filter-btn" data-filter="Macro" aria-pressed="false">Macro</button>
      <button class="filter-btn" data-filter="Risk" aria-pressed="false">Risk</button>
      <button class="filter-btn" data-filter="Structure" aria-pressed="false">Structure</button>
      <button class="filter-btn" data-filter="Psychology" aria-pressed="false">Psychology</button>
      <button class="filter-btn" data-filter="Process" aria-pressed="false">Process</button>
    </div>
    <div class="tools-bar">
      <button id="exportJsonBtn" type="button">Export JSON</button>
      <button id="exportMarkdownBtn" type="button">Export MD</button>
      <button id="downloadDayBtn" type="button">Download Today</button>
      <button id="clearAllBtn" type="button">Reset</button>
    </div>
    <div class="blog-grid" id="blogGrid" aria-live="polite" aria-busy="true"></div>
    <details class="panel" style="margin-top:var(--space-8)">
      <summary style="cursor:pointer;font-weight:600;letter-spacing:.5px;font-size:var(--fs-2)">Add Entry</summary>
      <form class="blog-form" id="blogForm" novalidate>
        <div style="display:flex;flex-wrap:wrap;gap:var(--space-4)">
          <input name="title" required maxlength="120" placeholder="Title">
          <select name="category" required>
            <option value="">Category</option>
            <option>Macro</option><option>Risk</option><option>Structure</option>
            <option>Psychology</option><option>Process</option>
          </select>
          <select name="sentiment" required>
            <option value="">Sentiment (1‑5)</option>
            <option value="1">1 - Stressed</option>
            <option value="2">2 - Cautious</option>
            <option value="3">3 - Neutral</option>
            <option value="4">4 - Focused</option>
            <option value="5">5 - Optimal</option>
          </select>
        </div>
        <textarea name="body" required maxlength="420" placeholder="Insight / scenario / reflection..."></textarea>
        <div class="char-counter" id="charCounter">0 / 420</div>
        <div class="small faint">Tip: Use "->" to auto bullet points.</div>
        <div style="display:flex;flex-wrap:wrap;gap:var(--space-4)">
          <button class="btn" type="submit">Publish</button>
          <button class="btn outline" type="button" id="clearPostsBtn">Clear (Seed)</button>
        </div>
      </form>
    </details>
  </div>
</section>

<!-- FRAMEWORK -->
<section id="framework" class="section" aria-labelledby="frameworkHeading">
  <div class="container">
    <div class="cta-box">
      <h2 id="frameworkHeading" style="margin:0">Execution Framework Cycle</h2>
      <p class="lead" style="margin:0 auto var(--space-5);max-width:780px">Context → Bias → Risk → Execute → Journal → Metrics → Adapt.</p>
      <ul class="framework-steps">
        <li><strong>1 Intake</strong><span>Macro catalysts + structure map + volatility regime.</span></li>
        <li><strong>2 Bias</strong><span>Scenario + triggers + invalidation clarity.</span></li>
        <li><strong>3 Risk</strong><span>Sizing anchored to volatility & structure distance.</span></li>
        <li><strong>4 Execute</strong><span>Only when criteria stack; skip marginal setups.</span></li>
        <li><strong>5 Journal</strong><span>Fast factual capture with emotional baseline.</span></li>
        <li><strong>6 Metrics</strong><span>Expectancy segmented by regime & setup.</span></li>
        <li><strong>7 Adapt</strong><span>Iterate constraints & filters from feedback.</span></li>
      </ul>
      <a href="#liveBlog" class="btn">Journal Now</a>
    </div>
  </div>
</section>

<footer class="site-footer">
  <div class="container footer-grid">
    <div>
      <h3 style="margin:0 0 var(--space-3);font-size:var(--fs-3)">Primus Traders</h3>
      <p class="small" style="margin:0;max-width:30ch">High‑impact clarity. Process over impulse.</p>
    </div>
    <nav aria-label="Footer navigation">
      <ul class="footer-links">
        <li><a href="#marketPulse">Calendar</a></li>
        <li><a href="#team">Traders</a></li>
        <li><a href="#marketNews">News</a></li>
        <li><a href="#liveBlog">Blog</a></li>
        <li><a href="#framework">Framework</a></li>
      </ul>
    </nav>
    <div class="small"><strong>Disclaimer:</strong> Educational only. No investment advice.</div>
  </div>
  <div class="small" style="text-align:center">© <span id="year"></span> Primus Traders. All rights reserved.</div>
</footer>

<button id="scrollTopBtn" aria-label="Scroll to top">↑</button>

<script src="https://s3.tradingview.com/tv.js" defer></script>
<script>
/* ========= UTIL / BASE ========= */
const qs = s => document.querySelector(s);
const qsa = s => [...document.querySelectorAll(s)];
const storage = {
  read:(k,d)=>{try{return JSON.parse(localStorage.getItem(k))??d}catch(_){return d}},
  write:(k,v)=>localStorage.setItem(k,JSON.stringify(v)),
  remove:k=>localStorage.removeItem(k)
};

/* ========= SPLASH ========= */
(function(){
 const splash=qs('#splash');if(!splash)return;
 const skip=qs('#splashSkip');const MIN_MS=1800;const start=performance.now();
 function end(){if(splash.classList.contains('hide'))return;splash.classList.add('hide');splash.setAttribute('aria-hidden','true');document.body.classList.remove('splash-lock');setTimeout(()=>splash.remove(),650);}
 skip.addEventListener('click',end);document.addEventListener('keydown',e=>{if(e.key==='Escape')end();});
 const waits=[];if(document.fonts&&document.fonts.ready)waits.push(document.fonts.ready);waits.push(new Promise(r=>window.addEventListener('load',r,{once:true})));
 Promise.all(waits).then(()=>{const elapsed=performance.now()-start;setTimeout(end,Math.max(0,MIN_MS-elapsed));});
 setTimeout(end,6000);
})();

/* ========= NAV ========= */
const navToggle=qs('#navToggle'),navMenu=qs('#navMenu');
navToggle?.addEventListener('click',()=>{const open=navMenu.classList.toggle('open');navToggle.setAttribute('aria-expanded',open);});
document.addEventListener('click',e=>{
 if(!navMenu.contains(e.target)&&!navToggle.contains(e.target)){
  navMenu.classList.remove('open');navToggle.setAttribute('aria-expanded','false');
 }
});

/* ========= YEAR + ScrollTop ========= */
qs('#year').textContent=new Date().getFullYear();
const scrollBtn=qs('#scrollTopBtn');window.addEventListener('scroll',()=>scrollBtn.classList.toggle('visible',window.scrollY>650));

/* ========= Catalyst Sample ========= */
const catalysts=[
 {label:"US CPI",m:90,exp:"3.1% YoY"},
 {label:"FOMC Minutes",m:180,exp:"Tone watch"},
 {label:"NFP",m:240,exp:"+180k"},
 {label:"Retail Sales",m:150,exp:"+0.4%"}
];
qs('#todayCatalyst').textContent=(()=>{
 const pick=catalysts[Math.floor(Math.random()*catalysts.length)];
 return `Today: ${pick.label} in ${pick.m}m | Exp ${pick.exp}`;
})();

/* ========= Multi-Asset TradingView Widget ========= */
let assetWidgetBuilt=false;
let currentSymbol="TVC:DXY";
const assets=[
 {sym:"TVC:DXY",label:"DXY",trend:"#b27934",fill:"rgba(178,121,52,.18)"},
 {sym:"CME_MINI:ES1!",label:"ES",trend:"#3a6ab2",fill:"rgba(58,106,178,.18)"},
 {sym:"COMEX:GC1!",label:"Gold",trend:"#c7902f",fill:"rgba(199,144,47,.18)"}
];
function buildAssetWidget(symbolObj){
 if(!window.TradingView)return;
 const el=qs('#multiAssetChart');el.innerHTML="";el.classList.add('loading');
 new TradingView.MediumWidget({
   symbols:[[symbolObj.label, symbolObj.sym]],
   width:"100%",height:300,chartOnly:false,locale:"en",
   colorTheme:"light",trendLineColor:symbolObj.trend,underLineColor:symbolObj.fill,fontColor:"#2e2721",
   isTransparent:true,autosize:true,showVolume:false,fontFamily:"Roboto, system-ui",container_id:"multiAssetChart",valuesTracking:"1"
 });
 setTimeout(()=>el.classList.remove('loading'),900);
}
function initAssetSwitcher(){
 const sw=qs('#assetSwitcher');
 sw.addEventListener('click',e=>{
  const btn=e.target.closest('button[data-symbol]');if(!btn)return;
  if(btn.dataset.symbol===currentSymbol)return;
  currentSymbol=btn.dataset.symbol;
  sw.querySelectorAll('button').forEach(b=>{
    const active=b.dataset.symbol===currentSymbol;
    b.classList.toggle('active',active);
    b.setAttribute('aria-selected',active?'true':'false');
  });
  const cfg=assets.find(a=>a.sym===currentSymbol)||assets[0];
  buildAssetWidget(cfg);
 });
 new IntersectionObserver(entries=>{
  entries.forEach(en=>{
    if(en.isIntersecting&&!assetWidgetBuilt&&window.TradingView){
      assetWidgetBuilt=true;buildAssetWidget(assets[0]);
    }
  });
 },{rootMargin:"200px"}).observe(qs('#multiAssetChart'));
}
initAssetSwitcher();

/* ========= Economic Calendar ========= */
function buildCalendar(){
 const t=qs('#mainCalendar');if(!t)return;
 t.innerHTML="";
 const s=document.createElement('script');
 s.src='https://s3.tradingview.com/external-embedding/embed-widget-events.js';
 s.async=true;
 s.innerHTML=JSON.stringify({colorTheme:"light",isTransparent:false,width:"100%",height:"480",locale:"en",importanceFilter:"1",currencyFilter:"USD"});
 t.appendChild(s);
}
document.addEventListener('DOMContentLoaded',buildCalendar);

/* ========= Positioning & Sentiment (Dynamic Fetch) =========
   We fetch JSON from either:
   1. /data/sentiment.json (static weekly file committed by automation)
   2. fallback endpoint /api/positioning (serverless / backend) if static not found
   3. fallback to previously stored localStorage snapshot or sample.

   Expected JSON shape:
   {
     "cot":{
        "weekEnding":"YYYY-MM-DD",
        "rows":[
          {"label":"Non-Comm Net","value":123,"prev":120,"max":80000},
          ...
        ]
     },
     "aaii":{
        "weekEnding":"YYYY-MM-DD",
        "data":[
          {"label":"Bullish","pct":38.5,"prev":36.1},
          {"label":"Neutral","pct":32.0,"prev":33.4},
          {"label":"Bearish","pct":29.5,"prev":30.5}
        ]
     },
     "updated":"ISODate"
   }
*/
const SENT_KEY='primus_sentiment_cache_v1';

function formatDelta(curr, prev){
 const diff=curr-prev;
 if(!isFinite(diff)) return {text:"",cls:""};
 if(Math.abs(diff) < 0.0001) return {text:"0",cls:""};
 const cls=diff>0?'delta-positive':'delta-negative';
 const sign=diff>0?'+':'';
 return {text:sign+(Math.abs(diff)<1?diff.toFixed(2):diff.toLocaleString()),cls};
}

function renderCOT(cot){
 const barsEl=qs('#cotBars');
 qs('#cotWeekLabel').textContent="Wk";
 qs('#cotDateLabel').textContent="Week Ending "+cot.weekEnding;
 barsEl.innerHTML="";
 cot.rows.forEach(r=>{
  const delta=formatDelta(r.value,r.prev);
  const pct=Math.min(100, Math.abs(r.value)/r.max*100);
  const posColor='linear-gradient(90deg,var(--accent),var(--accent-hover))';
  const negColor='linear-gradient(90deg,#b44838,#d36a58)';
  const row=document.createElement('div');
  row.className='cot-row';
  row.innerHTML=`
    <div class="cot-label">${r.label}</div>
    <div class="cot-bar-wrap">
      <div class="cot-bar" style="flex:1">
        <span style="width:${pct}%;background:${r.value>=0?posColor:negColor}"></span>
      </div>
      <div class="cot-val">${r.value.toLocaleString()} <span class="${delta.cls}" style="font-size:var(--fs-1)">${delta.text}</span></div>
    </div>`;
  barsEl.appendChild(row);
 });
}

function renderAAII(aaii){
 const grid=qs('#aaiiGrid');
 grid.innerHTML="";
 qs('#aaiiDateLabel').textContent="Week Ending "+aaii.weekEnding;
 aaii.data.forEach(d=>{
  const delta=formatDelta(d.pct,d.prev);
  const item=document.createElement('div');
  item.className='aaii-item';
  const width=Math.min(100,d.pct);
  const grad=d.label==="Bearish"?'linear-gradient(90deg,#b24838,#d36a58)':(d.label==="Neutral"?'linear-gradient(90deg,#8d806f,#b0a496)':'linear-gradient(90deg,var(--accent),var(--accent-hover))');
  item.innerHTML=`
    <h5>${d.label}</h5>
    <div style="font-weight:600;font-size:var(--fs-2)">${d.pct.toFixed(1)}% <span class="${delta.cls}" style="font-size:var(--fs-1);font-weight:700">${delta.text}%</span></div>
    <div class="aaii-bar"><span style="width:${width}%;background:${grad}"></span></div>
    <div class="small faint">Prev: ${d.prev.toFixed(1)}%</div>`;
  grid.appendChild(item);
 });
}

async function fetchSentiment(){
 const endpoints=[
   '/data/sentiment.json', // static (preferred if deployed)
   '/api/positioning'      // dynamic backend
 ];
 for(const url of endpoints){
  try{
    const res=await fetch(url,{cache:'no-store'});
    if(res.ok){
      const json=await res.json();
      return json;
    }
  }catch(_){/* try next */}
 }
 return null;
}

function applySentiment(json, persist=true){
 if(!json||!json.cot||!json.aaii) return;
 renderCOT(json.cot);
 renderAAII(json.aaii);
 if(persist) storage.write(SENT_KEY,json);
}

async function initSentiment(){
 // 1. Use cached (instant) while fetching new
 const cached=storage.read(SENT_KEY,null);
 if(cached){applySentiment(cached,false);}
 // 2. Fetch live
 const fresh=await fetchSentiment();
 if(fresh){applySentiment(fresh);}
 else if(!cached){
   // Absolute fallback sample (so section isn't empty on first load)
   applySentiment({
     cot:{
       weekEnding:"(sample)",
       rows:[
         {label:"Non-Comm Net",value:48000,prev:45500,max:80000},
         {label:"Comm Net",value:-51000,prev:-50000,max:80000},
         {label:"Non-Comm Long",value:123000,prev:122000,max:180000},
         {label:"Non-Comm Short",value:75000,prev:76500,max:180000}
       ]
     },
     aaii:{
       weekEnding:"(sample)",
       data:[
         {label:"Bullish",pct:38.5,prev:36.1},
         {label:"Neutral",pct:32.0,prev:33.4},
         {label:"Bearish",pct:29.5,prev:30.5}
       ]
     }
   },false);
 }
}
initSentiment();

/* ========= NEWS (unchanged logic) ========= */
const newsGrid=qs('#newsGrid'),newsSearch=qs('#newsSearch'),newsSource=qs('#newsSource'),newsTopic=qs('#newsTopic'),newsUpdated=qs('#newsUpdated'),newsTimer=qs('#newsTimer'),refreshNewsBtn=qs('#refreshNews'),pinnedWrap=qs('#pinnedNews');
let newsItems=[],pinnedIds=new Set(storage.read('primus_pins',[])),remaining=60;
function classifyTopic(t){t=t.toLowerCase();if(/fed|cpi|inflation|gdp|jobs|curve|policy/.test(t))return'macro';if(/equity|stock|earnings|nasdaq|s&p|dow/.test(t))return'equities';if(/yield|treasury|bond|rates/.test(t))return'rates';if(/fx|usd|eur|jpy|gbp|dollar|currency/.test(t))return'fx';if(/oil|gold|wti|brent|gas|copper/.test(t))return'commodities';if(/sentiment|fear|greed|risk-on|risk-off/.test(t))return'sentiment';return'macro';}
function buildNews(){
 const now=Date.now();
 const base=[
  {t:"Bloomberg: Fed Officials Signal Data Dependence",s:"Bloomberg",sum:"Policy flexibility persists into next decision window.",ts:now-1000*60*18},
  {t:"Reuters: Dollar Slips Ahead of CPI",s:"Reuters",sum:"FX vol muted; focus on core components.",ts:now-1000*60*42},
  {t:"MarketWatch: Crude Holds Gains on Supply Hints",s:"MarketWatch",sum:"Energy bid on inventory draw speculation.",ts:now-1000*60*70},
  {t:"Bloomberg: Yield Curve Steepening Rotations",s:"Bloomberg",sum:"Duration posture adjusting across funds.",ts:now-1000*60*115},
  {t:"Reuters: Equity Breadth Remains Narrow",s:"Reuters",sum:"Mega-cap concentration persists into close.",ts:now-1000*60*150}
 ];
 newsItems=base.map(n=>({id:'n'+n.ts,title:n.t,source:n.s,summary:n.sum,ts:n.ts,topic:classifyTopic(n.t),impact:/fed|cpi|inflation|yield|curve/i.test(n.t)?'High':'Med'}));
}
function relativeTime(ts){const diff=Date.now()-ts,m=Math.floor(diff/60000);if(m<1)return Math.floor(diff/1000)+'s ago';if(m<60)return m+'m ago';const h=Math.floor(m/60);if(h<24)return h+'h ago';return Math.floor(h/24)+'d ago';}
function escapeHtml(str){return str.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}
function renderPinned(){
 pinnedWrap.innerHTML='';
 const pinned=newsItems.filter(i=>pinnedIds.has(i.id));
 if(!pinned.length){
  const d=document.createElement('div');d.className='small faint';d.textContent='No pinned catalysts.';pinnedWrap.appendChild(d);return;
 }
 pinned.forEach(n=>{
  const el=document.createElement('div');el.className='small';el.style.display='flex';el.style.alignItems='center';el.style.gap='8px';
  el.innerHTML=`<span class="topic-badge">${n.topic}</span><strong style="font-size:var(--fs-1)">${escapeHtml(n.title)}</strong>`;
  pinnedWrap.appendChild(el);
 });
}
function renderNews(){
 newsGrid.setAttribute('aria-busy','true');
 const q=(newsSearch.value||'').trim().toLowerCase(),sf=newsSource.value,tf=newsTopic.value;
 newsGrid.innerHTML='';
 newsItems.filter(n=>(!q||n.title.toLowerCase().includes(q)||n.summary.toLowerCase().includes(q))&&(!sf||n.source===sf)&&(!tf||n.topic===tf))
  .forEach((n,i)=>{
   const card=document.createElement('article');
   card.className='news-card fade-in';
   card.style.animationDelay=(i*30)+'ms';
   card.innerHTML=`<div class="news-meta"><span class="topic-badge">${n.topic}</span><span>${n.source}</span><span>${relativeTime(n.ts)}</span><span>${n.impact}</span></div><h3 style="margin:.05rem 0 .25rem;font-size:var(--fs-3);line-height:1.25">${escapeHtml(n.title)}</h3><p style="margin:0;color:var(--text-soft);font-size:var(--fs-2);line-height:1.4">${escapeHtml(n.summary)}</p><div class="news-actions"><button class="icon-btn pin-btn ${pinnedIds.has(n.id)?'active':''}" data-id="${n.id}" aria-label="Pin headline">★</button></div>`;
   newsGrid.appendChild(card);
  });
 if(!newsGrid.children.length){
  const empty=document.createElement('div');empty.className='small faint';empty.textContent='No matching headlines.';newsGrid.appendChild(empty);
 }
 newsGrid.setAttribute('aria-busy','false');
 renderPinned();
}
function refreshNews(){buildNews();newsUpdated.textContent='Updated '+new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});renderNews();}
function newsTick(){remaining--;if(remaining<=0){remaining=60;refreshNews();}newsTimer.textContent='Auto: '+remaining+'s';}
function debounce(fn,d){let t;return(...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),d)}}
function initNews(){
 refreshNews();setInterval(newsTick,1000);
 const deb=debounce(renderNews,150);
 [newsSearch,newsSource,newsTopic].forEach(el=>el.addEventListener('input',deb));
 refreshNewsBtn.addEventListener('click',()=>{remaining=60;refreshNews();});
 newsGrid.addEventListener('click',e=>{
  const pin=e.target.closest('.pin-btn');if(pin){
   const id=pin.dataset.id;pinnedIds.has(id)?pinnedIds.delete(id):pinnedIds.add(id);
   storage.write('primus_pins',[...pinnedIds]);renderNews();
  }
 });
}
initNews();

/* ========= BLOG (unchanged) ========= */
const BLOG_KEY='primus_blog_v1',BLOG_FILTER_KEY='primus_blog_filter';
const blogGridEl=qs('#blogGrid'),blogForm=qs('#blogForm'),blogFilters=qs('#blogFilters'),charCounter=qs('#charCounter'),exportJsonBtn=qs('#exportJsonBtn'),exportMarkdownBtn=qs('#exportMarkdownBtn'),downloadDayBtn=qs('#downloadDayBtn'),clearAllBtn=qs('#clearAllBtn'),clearPostsBtn=qs('#clearPostsBtn');
const seedPosts=[
 {id:'seed-1',title:'Opening Prep Protocol',category:'Process',body:'Review macro catalysts -> mark key structure -> define scenarios.',sentiment:'4',ts:Date.now()-1000*60*240},
 {id:'seed-2',title:'Volatility Context',category:'Risk',body:'ATR > 30d avg +11%; per-trade risk ≤0.65R.',sentiment:'3',ts:Date.now()-1000*60*190},
 {id:'seed-3',title:'Liquidity Sweep Note',category:'Structure',body:'Sweep prior high + failure = potential reversal short.',sentiment:'4',ts:Date.now()-1000*60*140},
 {id:'seed-4',title:'Mindset Check',category:'Psychology',body:'Energy 7/10; watch early impatience.',sentiment:'4',ts:Date.now()-1000*60*90}
];
function loadPosts(){const raw=storage.read(BLOG_KEY,null);if(!raw){storage.write(BLOG_KEY,seedPosts);return seedPosts.slice();}return raw;}
function savePosts(p){storage.write(BLOG_KEY,p);}
let currentFilter=storage.read(BLOG_FILTER_KEY,'all');
function relativeTimeBlog(ts){const diff=Date.now()-ts,m=Math.floor(diff/60000);if(m<1)return Math.floor(diff/1000)+'s ago';if(m<60)return m+'m ago';const h=Math.floor(m/60);if(h<24)return h+'h ago';return Math.floor(h/24)+'d ago';}
function setFilterUI(){blogFilters.querySelectorAll('.filter-btn').forEach(b=>{const active=b.dataset.filter===currentFilter;b.classList.toggle('active',active);b.setAttribute('aria-pressed',active?'true':'false');});}
function escapeHtml(str){return str.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}
function renderPosts(){
 blogGridEl.setAttribute('aria-busy','true');
 const posts=loadPosts().sort((a,b)=>b.ts-a.ts);
 blogGridEl.innerHTML='';
 posts.filter(p=>currentFilter==='all'||p.category===currentFilter).forEach((p,i)=>{
  const card=document.createElement('article');
  card.className='post-card fade-in';
  card.style.animationDelay=(i*35)+'ms';
  const body=p.body.replace(/^->\s?/gm,'• ');
  card.innerHTML=`<span class="sentiment-ind" data-sent="${p.sentiment||'3'}"></span><div class="post-meta"><span class="badge">${p.category}</span><span data-ts="${p.ts}" class="rt">${relativeTimeBlog(p.ts)}</span><span>${p.sentiment?('S'+p.sentiment):''}</span></div><h3 style="margin:.05rem 0 .25rem;font-size:var(--fs-3);line-height:1.25">${escapeHtml(p.title)}</h3><p style="margin:0;color:var(--text-soft);font-size:var(--fs-2);line-height:1.42;white-space:pre-wrap">${escapeHtml(body)}</p>`;
  blogGridEl.appendChild(card);
 });
 if(!blogGridEl.children.length){
  const empty=document.createElement('div');empty.className='small faint';empty.textContent='No entries.';blogGridEl.appendChild(empty);
 }
 blogGridEl.setAttribute('aria-busy','false');
}
function addPost({title,category,body,sentiment}){
 const posts=loadPosts();posts.push({id:'p-'+Date.now(),title,category,body,sentiment,ts:Date.now()});savePosts(posts);renderPosts();
}
blogForm.addEventListener('input',()=>{charCounter.textContent=blogForm.body.value.length+' / 420';});
blogForm.addEventListener('submit',e=>{
 e.preventDefault();
 const fd=new FormData(blogForm);
 const title=fd.get('title').toString().trim();
 const category=fd.get('category').toString();
 const body=fd.get('body').toString().trim();
 const sentiment=fd.get('sentiment').toString();
 if(!title||!category||!body||!sentiment)return;
 addPost({title,category,body,sentiment});
 blogForm.reset();charCounter.textContent='0 / 420';
});
blogFilters.addEventListener('click',e=>{
 const btn=e.target.closest('.filter-btn');if(!btn)return;
 currentFilter=btn.dataset.filter;
 storage.write(BLOG_FILTER_KEY,currentFilter);
 setFilterUI();renderPosts();
});
clearPostsBtn.addEventListener('click',()=>{if(!confirm('Clear and restore seed posts?'))return;storage.remove(BLOG_KEY);renderPosts();});
clearAllBtn.addEventListener('click',()=>{if(!confirm('Remove all entries?'))return;storage.write(BLOG_KEY,[]);renderPosts();});
function downloadBlob(blob,name){const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=name;a.click();setTimeout(()=>URL.revokeObjectURL(a.href),1200);}
exportJsonBtn.addEventListener('click',()=>{downloadBlob(new Blob([JSON.stringify(loadPosts(),null,2)],{type:'application/json'}),'journal.json');});
exportMarkdownBtn.addEventListener('click',()=>{
 const md=loadPosts().sort((a,b)=>a.ts-b.ts).map(p=>`### ${p.title}\nCategory: ${p.category} | ${new Date(p.ts).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}\nSentiment: ${p.sentiment}\n\n${p.body}\n`).join('\\n');
 downloadBlob(new Blob([md],{type:'text/markdown'}),'journal.md');
});
downloadDayBtn.addEventListener('click',()=>{
 const day=new Date().toISOString().split('T')[0];
 const todays=loadPosts().filter(p=>new Date(p.ts).toISOString().startsWith(day));
 downloadBlob(new Blob([JSON.stringify(todays,null,2)],{type:'application/json'}),'journal-'+day+'.json');
});
setFilterUI();renderPosts();
setInterval(()=>qsa('.rt').forEach(el=>{
 const ts=+el.getAttribute('data-ts');el.textContent=relativeTimeBlog(ts);
}),15000);
</script>
</body>
</html>